<p align="center">
  <a href="https://github.com/node-ffi-packager"><img src="https://raw.githubusercontent.com/node-ffi-packager/resources/master/logotype/node-ffi-libraries.svg?sanitize=true" alt="node-ffi-libraries logotype, impossible cubes in orange" width="256" border="0" /></a>
</p>

# [<%= npmPackageName %>](<%= packageHomepage %>)

[Node.js](https://nodejs.org/en/) [Foreign Function Interface (FFI)](https://en.wikipedia.org/wiki/Foreign_function_interface) package for [`<%= libraryName %>`](<%= libraryHomepage %>) v<%= libraryVersion %>.

> **`<%= libraryName %>`**: <%= libraryDescription %>

[Bugs? Report them!](<%= packagerHomepage %>)

## Platforms supported in this package

<% Object.entries(platformsDetailsObject).forEach(([platformName, platformsDetails]) => { %>

<details>

<summary><%= platformName %></summary>

Conan package id `<%= platformsDetails.conan.packageId %>`.

### Library dependencies

<% if (Object.entries(platformsDetails.platform.libraryDependencies).length === 0) { %>
No library dependencies.
<% } %>

<% Object.entries(platformsDetails.platform.libraryDependencies).forEach(([libraryDependencyName, libraryDependencyVersion]) => { %>

- [`<%= libraryDependencyName %>` v<%= libraryDependencyVersion %>](https://github.com/<%= githubOrganizationName %>/node-ffi-library-<%= libraryDependencyName %>-v<%= libraryDependencyVersion %>) ([package branch `^v<%= packageBranch %>`](https://github.com/<%= githubOrganizationName %>/node-ffi-library-<%= libraryDependencyName %>-v<%= libraryDependencyVersion %>/branches/all?query=v<%= packageBranch.split(".")[0] %>))
  <% }); %>

### Header files

<% if (platformsDetails.platform.headerFiles.length === 0) { %>
No header files.
<% } %>

<% platformsDetails.platform.headerFiles.forEach((headerFile) => { %>

- [`<%= headerFile.name %>`](./platforms/<%= platformName %>/<%= headerFile.name.replace(/^\.\//, "") %>) ([`.js`](./platforms/<%= platformName %>/<%= headerFile.path.replace(/^\.\//, "") %>))
  <% }); %>

### Library files

<% if (Object.entries(platformsDetails.platform.libraryFiles).length === 0) { %>
No library files.
<% } %>

<% platformsDetails.platform.libraryFiles.forEach((libraryFile) => { %>

- [`<%= libraryFile %>`](./platforms/<%= platformName %>/<%= libraryFile.replace(/^\.\//, "") %>)
  <% }); %>

</details>

<% }); %>

## Installation

```shell
npm install --save <%= packageReference %>
```

## Example

```javascript
<%- include(
    "example.js",
    {
        npmPackageName: npmPackageName,
        randomExampleHeaderFile: (function getRandomExampleHeaderFile() {
            // TODO: break out function, use only result.
            const platformsDetailsObjectEntries = Object.entries(platformsDetailsObject);

            if (platformsDetailsObjectEntries.length === 0) {
              return null;
            }

            const randomPlatformsDetail = platformsDetailsObjectEntries[Math.floor(Math.random() * platformsDetailsObjectEntries.length)][1];
            const headerFiles =  randomPlatformsDetail.platform.headerFiles;

            if (headerFiles.length === 0) {
              return null;
            }

            // TODO: pick the main (most relevant, largest by bytesize) header file, since many are seemingly empty.
            const randomHeaderfile = headerFiles[Math.floor(Math.random() * headerFiles.length)];
            const randomHeaderfileName = randomHeaderfile.name;

            return randomHeaderfileName;
        }()),
    }
); %>
```

## Usage

- Used from [Node.js](https://nodejs.org/) (Javascript) to call the `<%= libraryName %>` dynamic library (C/C++).
  - No compilation required. All available binaries are included in the package and are loaded automatically.
  - Library header files are included, but most other documentation is not. See instead documentation for [`<%= libraryName %>`](<%= libraryHomepage %>).
- The `header` variable in the above example contains a Javascript object generated from the C/C++ header file.
  - C/C++ constants.
  - FFI typedefs.
  - Bindings to C/C++ functions.
- See the [Node.js FFI tutorial](https://github.com/node-ffi/node-ffi/wiki/Node-FFI-Tutorial) to get started.
  - Using [N-API](https://nodejs.org/dist/latest/docs/api/n-api.html) (`-napi`) versions of FFI libraries is required.
  - See [ffi-napi](https://github.com/node-ffi-napi/node-ffi-napi), [ref-napi](https://github.com/node-ffi-napi/ref-napi), and [related `-napi` packages](https://github.com/node-ffi-napi).

## Package information

- Repository/package automatically generated by [`<%= packagerName %>`](<%= packagerHomepage %>):
  - Version: v<%= packagerVersion %>
  - Generator run by: [<%= authorName %>](<%= authorHomepage %>)
- Repository published to [Github](https://github.com/):
  - Branch: [`<%= packageBranch %>`](https://github.com/<%= githubOrganizationName %>/<%= githubRepositoryName %>/tree/<%= packageBranch %>)
  - Repository: [`<%= githubRepositoryName %>`](https://github.com/<%= githubOrganizationName %>/<%= githubRepositoryName %>)
  - Organization: [`<%= githubOrganizationName %>`](https://github.com/<%= githubOrganizationName %>)
- <% if (npmPackagePrivate) { %>Package was _not_ published to [NPM](https://npmjs.com/).
  - Version: `<%= npmPackageVersion %>`<% if (npmPackageVersion === packagerVersion) { %> (based on the package generator version)<% } %>
  - Name: `<%= npmPackageName %>`
  - Organization/scope: `<%= npmOrganizationName %>`<% } else { %>Package published to [NPM](https://npmjs.com/):
  - Version: [`<%= npmPackageVersion %>`](https://npmjs.com/package/<%= npmPackageName %>/v/<%= npmPackageVersion %>)
  - Name: [`<%= npmPackageName %>`](https://npmjs.com/package/<%= npmPackageName %>)
  - Organization/scope: [`<%= npmOrganizationName %>`](https://npmjs.com/~<%= npmOrganizationName %>)<% } %>
- Library binaries made available by [Conan.io](https://conan.io/):
  - Package reference: [`<%= conanReference %>`](<%= conanUrl %>)
  - Conan remote: `<%= conanRemote %>`<% if (conanAuthor) { %>
  - Recipe authored by: <%= conanAuthor %><% } %>
- The library is [`<%= libraryName %>`](<%= libraryHomepage %>):
  - Version: v<%= libraryVersion %>
  - Description: "<%= libraryDescription %>"
  - License: <%- libraryLicenseHtml %>
  - Topics: <%= libraryTopicsArray.filter((topic) => topic !== "conan").join(", ") %>

---

[<%= npmPackageName %>](<%= packageHomepage %>) Copyright &copy; <%= new Date().getFullYear() %> [<%= authorName %>](<%= authorHomepage %>). License: <%- packageLicenseHtml %>.
